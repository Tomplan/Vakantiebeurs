<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>4x4 Vakantiebeurs Map</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      background: #f6f6f6;
      margin: 0;
      padding: 0;
    }
    .map-container {
      position: relative;
      width: 100vw;
      max-width: 100vw;
      min-height: 80vh;
      margin: 0;
      padding: 0;
      background: #fff;
      border-radius: 0;
      box-shadow: none;
      overflow: hidden;
    }
    .svg-bg {
      width: 100vw;
      height: 80vh;
      max-width: 100vw;
      max-height: 80vh;
      display: block;
      object-fit: contain;
      border-radius: 0;
    }
    .title-overlay {
      position: absolute;
      top: 5%;
      left: 50%;
      transform: translate(-50%, 0);
      color: #1976d2;
      background: rgba(255,255,255,0.85);
      padding: 0.6em 2.2em;
      border-radius: 16px;
      font-size: 2.2em;
      font-weight: bold;
      box-shadow: 0 2px 18px rgba(0,0,0,0.11);
      z-index: 5;
      pointer-events: none; /* allows click-through to map below */
      text-align: center;
    }
    .stand-circle {
      position: absolute;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background: #1976d2;
      color: #fff;
      text-align: center;
      line-height: 24px;
      font-size: 12px;
      cursor: pointer;
      border: 2px solid #fff;
      box-shadow: 0 2px 8px rgba(0,0,0,0.13);
      transition: background 0.2s;
      z-index: 2;
    }
    .stand-circle:hover, .stand-circle:focus { background: #004ba0; outline: none; }
    .modal-bg { 
      display: none; 
      position: fixed; 
      left:0;top:0;right:0;bottom:0;
      background:rgba(0,0,0,0.4); 
      align-items:center; 
      justify-content:center; 
      z-index: 100;
    }
    .modal { 
      background: #fff; 
      border-radius: 10px; 
      max-width: 340px; 
      padding: 2rem; 
      box-shadow: 0 4px 20px rgba(0,0,0,0.14);
    }
    .modal h2 { margin-top:0; margin-bottom: 0.5rem;}
    .modal-desc { margin-bottom: 0.8rem;}
    .close-btn { margin-top: 1rem; background: #1976d2; color: #fff; border: none; padding: 0.6rem 1.2rem; border-radius: 5px; cursor: pointer; font-size: 1rem;}
    .close-btn:hover { background: #004ba0;}
    @media (max-width: 600px) {
      .map-container { min-height: 320px; }
      .title-overlay { font-size: 1.2em; padding: 0.4em 1em; }
      .modal { max-width: 95vw; padding: 1rem; }
    }
  </style>
</head>
<body>
  <div class="map-container" id="map-container">
    <div class="title-overlay">Vakantiebeurs Event Map</div>
    <img src="src/map.svg" alt="Event Map" class="svg-bg" id="svg-map">
    <!-- Standholder circles will be placed by JS -->
  </div>
  
  <!-- Modal Popup -->
  <div class="modal-bg" id="modal-bg" onclick="hideModal()">
    <div class="modal" id="modal" onclick="event.stopPropagation()">
      <h2 id="modal-title"></h2>
      <p><b>Stand:</b> <span id="modal-stand"></span></p>
      <div class="modal-desc" id="modal-desc"></div>
      <p><a id="modal-link" href="#" target="_blank" style="color:#1976d2;text-decoration:underline;font-weight:bold;">Visit website</a></p>
      <button class="close-btn" onclick="hideModal()">Close</button>
    </div>
  </div>

  <script>
    // Load standholders.json and place circles
    fetch('src/data/standholders.json')
      .then(response => response.json())
      .then(standholders => {
        const container = document.getElementById('map-container');
        const svgImg = document.getElementById('svg-map');
        function placeCircles() {
          Array.from(document.getElementsByClassName('stand-circle')).forEach(e => e.remove());
          const rect = svgImg.getBoundingClientRect();
          const containerRect = container.getBoundingClientRect();
          const offsetLeft = rect.left - containerRect.left;
          const offsetTop = rect.top - containerRect.top;
          const width = rect.width;
          const height = rect.height;
          standholders.forEach((stand, i) => {
            // Stand coordinates are relative to SVG's viewBox (e.g. 0-700, 0-500)
            // Adjust these values based on your SVG's dimensions!
            const x = (stand.x / 700) * width + offsetLeft - 12; // center circle (half of width)
            const y = (stand.y / 500) * height + offsetTop - 12;
            const el = document.createElement('div');
            el.className = 'stand-circle';
            el.setAttribute('tabindex', '0');
            el.setAttribute('title', stand.name);
            el.style.left = x + 'px';
            el.style.top = y + 'px';
            el.textContent = stand.stand;
            el.onclick = () => showModal(stand);
            el.onkeydown = (e) => { if (e.key === 'Enter') showModal(stand); }
            container.appendChild(el);
          });
        }
        svgImg.onload = placeCircles;
        setTimeout(placeCircles, 1000);
        window.addEventListener('resize', placeCircles);
      });

    // Modal logic
    function showModal(stand) {
      document.getElementById("modal-title").textContent = stand.name;
      document.getElementById("modal-stand").textContent = stand.stand;
      document.getElementById("modal-desc").textContent = stand.description;
      document.getElementById("modal-link").href = stand.website;
      document.getElementById("modal-link").textContent = (stand.website ? "Visit website" : "");
      document.getElementById("modal-bg").style.display = "flex";
    }
    function hideModal() {
      document.getElementById("modal-bg").style.display = "none";
    }
  </script>
</body>
</html>
